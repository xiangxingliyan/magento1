WindowStore={doSetCookie:!1,cookieName:"__window_store__",expired:null,init:function(o,e){if(WindowStore.cookieName=o||WindowStore.cookieName,e)WindowStore.expired=e;else{var i=new Date;i.setYear(i.getYear()+1903),WindowStore.expired=i}Windows.windows.each(function(o){o.setCookie(o.getId(),WindowStore.expired)});var n={onShow:function(o,e){WindowStore._saveCookie()},onClose:function(o,e){WindowStore._saveCookie()},onHide:function(o,e){WindowStore._saveCookie()}};Windows.addObserver(n),WindowStore._restoreWindows(),WindowStore._saveCookie()},show:function(win){eval("var cookie = "+WindowUtilities.getCookie(WindowStore.cookieName)),null!=cookie?cookie[win.getId()]&&win.show():win.show()},_saveCookie:function(){if(doSetCookie){var o="{";Windows.windows.each(function(e){"{"!=o&&(o+=","),o+=e.getId()+": "+e.isVisible()}),o+="}",WindowUtilities.setCookie(o,[WindowStore.cookieName,WindowStore.expired])}},_restoreWindows:function(){eval("var cookie = "+WindowUtilities.getCookie(WindowStore.cookieName)),null!=cookie&&(doSetCookie=!1,Windows.windows.each(function(o){cookie[o.getId()]&&o.show()})),doSetCookie=!0}},WindowCloseKey={keyCode:Event.KEY_ESC,init:function(o){o&&(WindowCloseKey.keyCode=o),Event.observe(document,"keydown",this._closeCurrentWindow.bindAsEventListener(this))},_closeCurrentWindow:function(o){var e=o||window.event,i=e.which||e.keyCode,n=top.Windows.focusedWindow;i==WindowCloseKey.keyCode&&n&&(n.cancelCallback?top.Dialog.cancelCallback():n.okCallback?top.Dialog.okCallback():top.Windows.close(top.Windows.focusedWindow.getId()))}};